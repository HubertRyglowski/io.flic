<!doctype html>
<html>
<head>
    <script type="text/javascript" src="/homey.js" data-origin="settings"></script>
    <style>
        #notice {
            color: green;
        }
        .note {
            margin: 0 0 1em 0;
            display: inline-block;
        }
        .setting-row{
            width: 100%;
        }
        #updateInterval{
            width:55px;
            padding: 5px 10px;
        }
    </style>
</head>
<body>

<h1 data-i18n="settings.title"></h1>

<fieldset>
    <legend>
        <p data-i18n="settings.title"></p>
    </legend>

    <table class="setting-row">
        <tbody>
        <tr>
            <td>
                <label for="webhookid"></label>
                    <p data-i18n="settings.webhook.id"></p>
                </label>
            <td>
                <input id="webhookid" class="left" type="text"/> 
            </td>
        </tr>
        <tr>
            <td>
                <label for="webhooksecret"></label>
                    <p data-i18n="settings.webhook.secret"></p>
                </label>
            <td>
                <input id="webhooksecret" class="left" type="text"/> 
            </td>
        </tr>
        <tr>
            <i data-i18n="settings.webhook.info" class="note"></i>
            <i data-i18n="settings.webhook.info2" class="note"></i>
            <i data-i18n="settings.webhook.info3" class="note"></i>
        </tr>
        </tbody>
    </table>
</fieldset>

<div class="field row">
    <button id="save" class="right"><p data-i18n="settings.save.label"></p></button>
</div>

<script type="text/javascript">

    function onHomeyReady(Homey) {
        Homey.ready();
        let updateWebhookIdElement = document.getElementById('webhookid');
        Homey.get('webhookid', function (err, webhookid) {
            if (err) return Homey.alert(err);
            updateWebhookIdElement.value = webhookid;
        });
        let updateWebhookSecretElement = document.getElementById('webhooksecret');
        Homey.get('webhooksecret', function (err, webhooksecret) {
            if (err) return Homey.alert(err);
            updateWebhookSecretElement.value = webhooksecret;
        });

        let saveElement = document.getElementById('save');
        saveElement.addEventListener('click', function (e) {
            Homey.set('webhookid', updateWebhookIdElement.value, function (err) {
                if (err) return Homey.alert(err);
            });
            Homey.set('webhooksecret', updateWebhookSecretElement.value, function (err) {
                if (err) return Homey.alert(err);
            });
            Homey.alert(__("settings.success"));
        });
    }
</script>

</body>
</html>